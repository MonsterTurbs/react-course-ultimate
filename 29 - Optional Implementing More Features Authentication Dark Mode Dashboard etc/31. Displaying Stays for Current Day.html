

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>React Dashboard â€” Today Activity (Check-ins & Check-outs) | Study Guide</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #111111;
      --muted: #555555;
      --soft: #f6f7f9;
      --border: #e6e6e6;
      --code-bg: #0b1020;
      --code-text: #e8eefc;
      --accent: #0b57d0;
      --ok: #0f8a3c;
      --warn: #b35c00;
      --bad: #b00020;

      /* Print tuning */
      --print-font: 11.5pt;
      --print-line: 1.45;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Arial, Helvetica, sans-serif;
      line-height: 1.6;
      overflow-wrap: anywhere;
      word-break: break-word;
    }

    /* Single-column page */
    .page {
      max-width: 900px;
      margin: 0 auto;
      padding: 28px 20px 60px;
    }

    header {
      border: 1px solid var(--border);
      background: #fff;
      padding: 18px 18px 14px;
      border-radius: 12px;
    }

    h1 {
      margin: 0 0 6px;
      font-size: 22px;
      letter-spacing: 0.2px;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 13.5px;
    }

    .meta {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: var(--soft);
      font-size: 12.5px;
      color: var(--text);
    }

    .chip b { font-weight: 700; }

    nav {
      margin: 16px 0 0;
      padding-top: 12px;
      border-top: 1px dashed var(--border);
    }

    nav .toc-title {
      margin: 0 0 8px;
      font-size: 13px;
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .2px;
      text-transform: uppercase;
    }

    nav ul {
      margin: 0;
      padding-left: 18px;
    }

    nav li { margin: 6px 0; }

    nav a {
      color: var(--accent);
      text-decoration: none;
    }

    nav a:hover { text-decoration: underline; }

    section {
      margin-top: 16px;
      padding: 18px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: #fff;
    }

    h2 {
      margin: 0 0 10px;
      font-size: 18px;
    }

    h3 {
      margin: 14px 0 8px;
      font-size: 15px;
    }

    p { margin: 10px 0; }

    .callout {
      border-left: 5px solid var(--accent);
      background: var(--soft);
      padding: 12px 12px;
      border-radius: 10px;
      margin: 12px 0;
    }

    .callout.ok { border-left-color: var(--ok); }
    .callout.warn { border-left-color: var(--warn); }
    .callout.bad { border-left-color: var(--bad); }

    .callout .title {
      margin: 0 0 6px;
      font-weight: 700;
    }

    ul, ol {
      margin: 10px 0;
      padding-left: 22px;
    }

    li { margin: 6px 0; }

    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    pre {
      margin: 12px 0;
      padding: 12px;
      border-radius: 12px;
      background: var(--code-bg);
      color: var(--code-text);
      overflow: auto;
      border: 1px solid rgba(255,255,255,.08);
    }

    pre code { white-space: pre; }

    .two-col {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .mini {
      font-size: 12.5px;
      color: var(--muted);
    }

    .kbd {
      display: inline-block;
      border: 1px solid var(--border);
      background: var(--soft);
      padding: 1px 6px;
      border-radius: 6px;
      font-size: 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .divider {
      height: 1px;
      background: var(--border);
      margin: 14px 0;
    }

    footer {
      margin-top: 16px;
      color: var(--muted);
      font-size: 12.5px;
      text-align: center;
    }

    /* Print-specific CSS for clean A4 output */
    @page { size: A4; margin: 14mm; }

    @media print {
      body { font-size: var(--print-font); line-height: var(--print-line); }
      .page { max-width: none; padding: 0; }
      header, section { border: 1px solid #cfcfcf; box-shadow: none; }
      nav a { color: #000; text-decoration: none; }

      /* Donâ€™t print link URLs */
      a[href]:after { content: "" !important; }

      /* Keep code readable on print */
      pre {
        background: #f4f4f4;
        color: #111;
        border: 1px solid #d8d8d8;
      }

      /* Avoid awkward breaks */
      h1, h2, h3 { page-break-after: avoid; }
      section, header { break-inside: avoid; page-break-inside: avoid; }

      /* Hide hover-only behaviors (none here), keep it clean */
    }
  </style>
</head>
<body>
  <main class="page">
    <header>
      <h1>ğŸ“‹ Today Activity (Check-ins & Check-outs) â€” Dashboard Feature</h1>
      <p class="subtitle">
        Study guide from the lecture transcript: implementing the <b>TodayActivity</b> list that shows <b>arrivals</b> (check-ins) and <b>departures</b> (check-outs) for the current day, powered by <b>Supabase</b> + <b>React Query</b>.
      </p>

      <div class="meta">
        <span class="chip">ğŸ¯ <b>Goal:</b> show todayâ€™s arrivals & departures</span>
        <span class="chip">ğŸ§  <b>Concepts:</b> filtering â€œactivitiesâ€, conditional UI</span>
        <span class="chip">âš™ï¸ <b>Stack:</b> Supabase + React Query + React Router</span>
        <span class="chip">âœ… <b>Outcome:</b> Check in/out directly from dashboard</span>
      </div>

      <nav>
        <div class="toc-title">Table of contents</div>
        <ul>
          <li><a href="#big-picture">Big picture</a></li>
          <li><a href="#activity-definition">What counts as â€œToday Activityâ€?</a></li>
          <li><a href="#supabase-query">Supabase query (OR + AND)</a></li>
          <li><a href="#react-query-hook">React Query hook: useTodayActivity</a></li>
          <li><a href="#rendering-ui">Rendering the list (spinner + empty state)</a></li>
          <li><a href="#today-item">TodayItem UI (Arriving/Departing tags)</a></li>
          <li><a href="#checkin-checkout">Buttons: Check in (Link) & Check out (mutation)</a></li>
          <li><a href="#debug">Common bugs & quick fixes</a></li>
          <li><a href="#mini-review">Quick review (cheat sheet)</a></li>
        </ul>
      </nav>
    </header>

    <section id="big-picture">
      <h2>ğŸ§­ Big picture</h2>
      <p>
        Youâ€™re building the last dashboard feature: a compact list that shows <b>who arrives today</b> and <b>who leaves today</b>.
        In the UI, it lives on the dashboard, but in the project structure itâ€™s stored under the <b>check-in-out</b> feature folder.
      </p>

      <div class="callout ok">
        <p class="title">âœ… Key idea</p>
        <p>
          â€œFolders are about <b>features</b>, not where components appear on the screen.â€
          TodayActivity belongs to the check-in/out feature because it triggers check-in/out actions.
        </p>
      </div>

      <h3>What you will build</h3>
      <ul>
        <li>Fetch only the bookings that matter <b>today</b> (donâ€™t download the entire bookings table).</li>
        <li>Show a <b>spinner</b> while loading, and an <b>empty message</b> when there is no activity.</li>
        <li>Render each activity with: <b>Arriving/Departing</b> tag, country flag, guest name, nights, and an action button.</li>
        <li>Action buttons:
          <ul>
            <li>Arriving â†’ <b>Check in</b> (navigate to the Check-in route)</li>
            <li>Departing â†’ <b>Check out</b> (run a mutation)</li>
          </ul>
        </li>
      </ul>
    </section>

    <section id="activity-definition">
      <h2>ğŸ§© What counts as â€œToday Activityâ€?</h2>
      <p>
        An <b>activity</b> is either a guest who should <b>check in today</b> or a guest who should <b>check out today</b>.
        The lecture defines it using booking <b>status</b> and booking dates.
      </p>

      <div class="two-col">
        <div class="callout">
          <p class="title">ğŸŸ¢ Arriving (Check-in)</p>
          <ul>
            <li><b>Status:</b> <span class="kbd">unconfirmed</span></li>
            <li><b>Start date:</b> <span class="kbd">today</span></li>
          </ul>
          <p class="mini">Meaning: guest is scheduled to start today, but hasnâ€™t been checked in yet.</p>
        </div>

        <div class="callout">
          <p class="title">ğŸ”µ Departing (Check-out)</p>
          <ul>
            <li><b>Status:</b> <span class="kbd">checked-in</span></li>
            <li><b>End date:</b> <span class="kbd">today</span></li>
          </ul>
          <p class="mini">Meaning: guest is currently checked in and should leave today.</p>
        </div>
      </div>

      <div class="callout warn">
        <p class="title">âš ï¸ Why you should NOT fetch all bookings</p>
        <p>
          If you fetch all bookings and filter in JavaScript, you could end up downloading a huge dataset.
          Instead, push the filtering into Supabase using a query.
        </p>
      </div>
    </section>

    <section id="supabase-query">
      <h2>ğŸ—„ï¸ Supabase query (OR + AND)</h2>
      <p>
        The lecture uses a Supabase query that represents:
        <b>(Arriving condition) OR (Departing condition)</b>.
        This is done with an <span class="kbd">.or()</span> call whose string contains two â€œpartsâ€, separated by a comma.
        Each part can itself be an AND group.
      </p>

      <div class="callout">
        <p class="title">ğŸ§  Mental model</p>
        <p>
          Think of it as writing SQL-like logic, but encoded as a string:
          <b>(A AND B) OR (C AND D)</b>
        </p>
      </div>

      <pre><code>// services/apiBookings.js (example shape)
export async function getStaysTodayActivity() {
  const todayStart = /* start of today (ISO) */;
  const todayEnd = /* end of today (ISO) */;

  const { data, error } = await supabase
    .from("bookings")
    .select("*, guests(fullName, country, countryFlag)")
    .or(
      [
        // Arriving: unconfirmed AND startDate is today
        `and(status.eq.unconfirmed,startDate.gte.${todayStart},startDate.lte.${todayEnd})`,

        // Departing: checked-in AND endDate is today
        `and(status.eq.checked-in,endDate.gte.${todayStart},endDate.lte.${todayEnd})`,
      ].join(",")
    );

  if (error) throw new Error(error.message);
  return data;
}
</code></pre>

      <p class="mini">
        Notes: Your project may compute â€œtodayâ€ using helper functions that return ISO strings.
        The key takeaway is the OR-with-AND-grouping pattern.
      </p>
    </section>

    <section id="react-query-hook">
      <h2>âš¡ React Query hook: <span class="kbd">useTodayActivity</span></h2>
      <p>
        Next, wrap the API call inside a React Query hook. This gives you:
        <b>loading state</b>, caching, refetching, and a clean API in the component.
      </p>

      <pre><code>// features/check-in-out/useTodayActivity.js
import { useQuery } from "@tanstack/react-query";
import { getStaysTodayActivity } from "../../services/apiBookings";

export function useTodayActivity() {
  const { isLoading, data: activities } = useQuery({
    queryKey: ["today-activity"],
    queryFn: getStaysTodayActivity,
  });

  return { isLoading, activities };
}
</code></pre>

      <div class="callout ok">
        <p class="title">âœ… Why the query key is an array</p>
        <p>
          React Query query keys are commonly arrays to support â€œnamespacingâ€ and future parameters.
          Even if itâ€™s a single key, <span class="kbd">["today-activity"]</span> is the safe convention.
        </p>
      </div>
    </section>

    <section id="rendering-ui">
      <h2>ğŸ§± Rendering the list (spinner + empty state)</h2>
      <p>
        In <b>TodayActivity</b>, you fetch the activities using the hook, then render:
      </p>
      <ol>
        <li>Title row</li>
        <li>While loading â†’ show spinner</li>
        <li>If no activity â†’ show â€œNo activity todayâ€</li>
        <li>Otherwise â†’ map activities to <b>TodayItem</b></li>
      </ol>

      <pre><code>// features/check-in-out/TodayActivity.jsx (core idea)
import Spinner from "../../ui/Spinner";
import TodayItem from "./TodayItem";
import { useTodayActivity } from "./useTodayActivity";

export default function TodayActivity() {
  const { isLoading, activities } = useTodayActivity();

  return (
    &lt;div&gt;
      &lt;h2&gt;Today&lt;/h2&gt;

      {isLoading ? (
        &lt;Spinner /&gt;
      ) : activities?.length &gt; 0 ? (
        &lt;ul&gt;
          {activities.map((activity) =&gt; (
            &lt;TodayItem key={activity.id} activity={activity} /&gt;
          ))}
        &lt;/ul&gt;
      ) : (
        &lt;p&gt;No activity today.&lt;/p&gt;
      )}
    &lt;/div&gt;
  );
}
</code></pre>

      <div class="callout warn">
        <p class="title">âš ï¸ Naming tip</p>
        <p>
          The lecture suggests renaming â€œstaysâ€ to â€œactivitiesâ€ to better match what the list represents.
          Clear naming makes the code easier to reason about.
        </p>
      </div>
    </section>

    <section id="today-item">
      <h2>ğŸ·ï¸ TodayItem UI (Arriving/Departing tags)</h2>
      <p>
        Each activity is still a booking, so you can destructure common booking fields like:
        <span class="kbd">id</span>, <span class="kbd">status</span>, <span class="kbd">guests</span>, <span class="kbd">numNights</span>.
      </p>

      <h3>1) Arriving vs Departing tag</h3>
      <ul>
        <li>Status <span class="kbd">unconfirmed</span> â†’ Tag: <b>Arriving</b> (green)</li>
        <li>Status <span class="kbd">checked-in</span> â†’ Tag: <b>Departing</b> (blue)</li>
      </ul>

      <pre><code>// TodayItem.jsx (core idea)
import Tag from "../../ui/Tag";
import Flag from "../../ui/Flag";

export default function TodayItem({ activity }) {
  const { id, status, guests, numNights } = activity;

  return (
    &lt;li&gt;
      {status === "unconfirmed" ? (
        &lt;Tag type="green"&gt;Arriving&lt;/Tag&gt;
      ) : (
        &lt;Tag type="blue"&gt;Departing&lt;/Tag&gt;
      )}

      &lt;Flag
        src={guests.countryFlag}
        alt={`Flag of ${guests.country}`}
      /&gt;

      &lt;span&gt;{guests.fullName}&lt;/span&gt;
      &lt;div&gt;{numNights} nights&lt;/div&gt;

      {/* Buttons go here (next section) */}
    &lt;/li&gt;
  );
}
</code></pre>

      <div class="callout ok">
        <p class="title">âœ… Beginner-friendly reminder</p>
        <p>
          <b>Destructuring</b> is just a shortcut. Instead of writing <span class="kbd">activity.status</span> repeatedly,
          you do <span class="kbd">const { status } = activity</span>.
        </p>
      </div>
    </section>

    <section id="checkin-checkout">
      <h2>ğŸšª Buttons: Check in (Link) & Check out (mutation)</h2>

      <h3>ğŸŸ¢ Check in button (navigate to Check-in page)</h3>
      <p>
        For arriving guests (unconfirmed), clicking <b>Check in</b> should take you to a route like:
        <span class="kbd">/checkin/:bookingId</span>.
      </p>

      <pre><code>// Inside TodayItem, for "unconfirmed"
import { Link } from "react-router-dom";
import Button from "../../ui/Button";

&lt;Button
  size="small"
  variation="primary"
  as={Link}
  to={`/checkin/${id}`}
&gt;
  Check in
&lt;/Button&gt;
</code></pre>

      <div class="callout">
        <p class="title">ğŸ§  Why use <span class="kbd">as={Link}</span>?</p>
        <p>
          You keep your appâ€™s button styling (from the Button component), but render it as a React Router <b>Link</b>
          so it navigates without a full page reload.
        </p>
      </div>

      <div class="divider"></div>

      <h3>ğŸ”µ Check out button (run a mutation)</h3>
      <p>
        For departing guests (checked-in), you typically need more logic (mutation + loading state),
        so the lecture extracts it to a <b>CheckoutButton</b> component.
      </p>

      <pre><code>// CheckoutButton.jsx (core idea)
import Button from "../../ui/Button";
import { useCheckout } from "./useCheckout";

export default function CheckoutButton({ bookingId }) {
  const { checkout, isCheckingOut } = useCheckout();

  return (
    &lt;Button
      size="small"
      variation="primary"
      disabled={isCheckingOut}
      onClick={() =&gt; checkout(bookingId)}
    &gt;
      Check out
    &lt;/Button&gt;
  );
}
</code></pre>

      <div class="callout ok">
        <p class="title">âœ… Expected result after actions</p>
        <ul>
          <li>After check-in: the guest disappears from â€œArrivingâ€ list (status changes).</li>
          <li>Dashboard stats/charts can update if queries are invalidated/refetched.</li>
          <li>After check-out: the guest is no longer â€œchecked-in ending todayâ€.</li>
        </ul>
      </div>
    </section>

    <section id="debug">
      <h2>ğŸ› ï¸ Common bugs & quick fixes</h2>

      <div class="callout bad">
        <p class="title">ğŸ Export/Import mismatch</p>
        <p>
          If your component exports <span class="kbd">Today</span> but you import <span class="kbd">TodayActivity</span>, youâ€™ll get errors.
          Align the export name with the import name.
        </p>
      </div>

      <div class="callout warn">
        <p class="title">ğŸ Button prop mismatch (size vs type)</p>
        <p>
          If your button suddenly breaks layout, check prop names. The lecture highlights a mistake where <b>type</b>
          was used instead of <b>size</b>. Ensure you use the correct prop expected by your Button component.
        </p>
      </div>

      <div class="callout">
        <p class="title">ğŸ Unexpected wrapping / lack of space</p>
        <p>
          If items wrap to a new line, inspect your styled component (flex settings, gap, min-width).
          Often you can fix it with:
        </p>
        <ul>
          <li><span class="kbd">display: flex</span>, <span class="kbd">align-items: center</span></li>
          <li>Reduce text width or allow horizontal scroll only inside the list container</li>
          <li>Make sure the action button is not too wide</li>
        </ul>
      </div>

      <div class="callout ok">
        <p class="title">âœ… Debugging routine (fast)</p>
        <ol>
          <li>Confirm the API returns only todayâ€™s arrivals/departures.</li>
          <li>Verify query key is correct and stable (e.g., <span class="kbd">["today-activity"]</span>).</li>
          <li>Check status strings exactly match your DB values (case-sensitive).</li>
          <li>Open React Query devtools and confirm the query has data.</li>
        </ol>
      </div>
    </section>

    <section id="mini-review">
      <h2>ğŸ§¾ Quick review (cheat sheet)</h2>
      <ul>
        <li>ğŸ¯ <b>Today Activity</b> = (unconfirmed &amp; starts today) OR (checked-in &amp; ends today)</li>
        <li>ğŸ—„ï¸ Do filtering in Supabase (efficient) rather than downloading all bookings</li>
        <li>âš¡ Wrap API in <b>React Query</b> â†’ <span class="kbd">useTodayActivity</span></li>
        <li>ğŸ§± UI states:
          <ul>
            <li>â³ Loading â†’ spinner</li>
            <li>ğŸ˜´ No results â†’ â€œNo activity todayâ€</li>
            <li>âœ… Results â†’ map to TodayItem</li>
          </ul>
        </li>
        <li>ğŸ·ï¸ Tag logic:
          <ul>
            <li>ğŸŸ¢ Arriving if status is <span class="kbd">unconfirmed</span></li>
            <li>ğŸ”µ Departing if status is <span class="kbd">checked-in</span></li>
          </ul>
        </li>
        <li>ğŸšª Actions:
          <ul>
            <li>Check in = styled Button rendered as Link (<span class="kbd">as={Link}</span>)</li>
            <li>Check out = mutation in CheckoutButton with loading state</li>
          </ul>
        </li>
      </ul>

      <div class="callout ok">
        <p class="title">ğŸ Whatâ€™s next in the course</p>
        <p>
          After completing the dashboard, the lecture mentions finishing touches and small fixes in follow-up videos.
          At this stage, you have a highly realistic production-style app feature set.
        </p>
      </div>
    </section>

    <footer>
      Prepared as an A4 print-friendly single-column reviewer/study guide.
    </footer>
  </main>
</body>
</html>