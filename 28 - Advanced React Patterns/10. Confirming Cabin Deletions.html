

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advanced React Patterns ‚Äî Confirming Cabin Deletions (Modal Reuse)</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #111111;
      --muted: #555555;
      --border: #e6e6e6;
      --soft: #f7f7f7;
      --codebg: #0b1020;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Arial, Helvetica, sans-serif;
      line-height: 1.6;
      overflow-wrap: anywhere;
      word-break: break-word;
    }

    /* Single-column page */
    .page {
      max-width: 900px;
      margin: 0 auto;
      padding: 28px 18px 60px;
    }

    header {
      border: 1px solid var(--border);
      background: #fff;
      padding: 18px 18px 14px;
      border-radius: 12px;
    }

    h1 {
      margin: 0 0 6px;
      font-size: 22px;
      letter-spacing: .2px;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
    }

    .meta {
      margin-top: 10px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .chip {
      border: 1px solid var(--border);
      background: var(--soft);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: #222;
    }

    section {
      margin-top: 18px;
      border: 1px solid var(--border);
      background: #fff;
      padding: 16px 18px;
      border-radius: 12px;
    }

    h2 {
      margin: 0 0 8px;
      font-size: 16px;
    }

    h3 {
      margin: 14px 0 6px;
      font-size: 14px;
    }

    p { margin: 8px 0; }
    ul { margin: 8px 0 0 18px; }
    li { margin: 6px 0; }

    .callout {
      border-left: 4px solid #111;
      background: var(--soft);
      padding: 10px 12px;
      border-radius: 10px;
      margin: 10px 0;
    }

    .callout strong { display: inline-block; margin-bottom: 4px; }

    pre {
      margin: 10px 0;
      padding: 12px;
      background: var(--codebg);
      color: #e9eefc;
      border-radius: 10px;
      overflow: auto;
      border: 1px solid rgba(255,255,255,.12);
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
    }

    .kbd {
      border: 1px solid var(--border);
      background: #fff;
      padding: 1px 6px;
      border-radius: 6px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
    }

    .grid2 {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 820px) {
      .grid2 { grid-template-columns: 1fr 1fr; }
    }

    /* PRINT (A4) */
    @page {
      size: A4;
      margin: 14mm;
    }

    @media print {
      body {
        background: #fff;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      .page {
        max-width: none;
        padding: 0;
      }

      header, section {
        border: 1px solid #d9d9d9;
        border-radius: 0;
        box-shadow: none;
        break-inside: avoid;
      }

      pre {
        break-inside: avoid;
      }

      a, a:visited {
        color: inherit;
        text-decoration: none;
      }

      /* Ensure no URLs appear on print */
      a[href]::after { content: ""; }
    }
  </style>
</head>
<body>
  <main class="page">
    <header>
      <h1>üß© Confirming Cabin Deletions (Reusing the Compound Modal)</h1>
      <p class="subtitle">Reviewer / Study Guide ‚Äî Modal reuse for <strong>Edit</strong> and <strong>Delete confirmation</strong> in the Cabins feature.</p>
      <div class="meta">
        <span class="chip">Single-column</span>
        <span class="chip">A4 print-ready</span>
        <span class="chip">React ‚Ä¢ Compound Components</span>
        <span class="chip">Modal.Open / Modal.Window</span>
      </div>
    </header>

    <section>
      <h2>‚úÖ What you are building</h2>
      <p>
        You will reuse your compound <strong>Modal</strong> two more times:
      </p>
      <ul>
        <li>‚úèÔ∏è <strong>Edit a cabin</strong> inside a modal (using <code>CreateCabinForm</code> prefilled).</li>
        <li>üóëÔ∏è <strong>Confirm cabin deletion</strong> inside a modal (using a reusable <code>ConfirmDelete</code> component).</li>
      </ul>
      <div class="callout">
        <strong>Key benefit:</strong>
        You no longer need row-level <code>useState</code> like <code>showForm</code> to toggle edit UI. The <strong>Modal</strong> keeps open/close state internally.
      </div>
    </section>

    <section>
      <h2>üß† Mental model: ‚ÄúModal as an API‚Äù</h2>
      <p>
        Your compound modal has an expressive API:
      </p>
      <pre><code>&lt;Modal&gt;
  &lt;Modal.Open opens="edit"&gt;
    &lt;Button&gt;Edit&lt;/Button&gt;
  &lt;/Modal.Open&gt;

  &lt;Modal.Window name="edit"&gt;
    &lt;CreateCabinForm cabinToEdit={cabin} /&gt;
  &lt;/Modal.Window&gt;
&lt;/Modal&gt;</code></pre>
      <ul>
        <li><code>Modal.Open</code> = the ‚Äútrigger‚Äù (button/icon) üü¶</li>
        <li><code>Modal.Window</code> = the content that appears in the portal ü™ü</li>
        <li><code>opens</code> and <code>name</code> connect trigger ‚Üí window üîó</li>
      </ul>
    </section>

    <section>
      <h2>üßπ Step 1 ‚Äî Cleanup (optional but recommended)</h2>
      <ul>
        <li>Remove the extra ‚Äútable‚Äù modal window demo (keep only what you need for cabins).</li>
        <li>Wrap the modal in a <code>&lt;div&gt;</code> so the open button doesn‚Äôt stretch or occupy weird space.</li>
        <li>Delete unused imports/handlers/states to make the component readable.</li>
      </ul>
      <div class="callout">
        <strong>Rule of thumb:</strong> pages should be ‚Äúthin‚Äù (minimal state/effects). Put interactive logic in feature components.
      </div>
    </section>

    <section>
      <h2>‚úèÔ∏è Step 2 ‚Äî Edit cabin using the modal (CabinRow)</h2>
      <p>
        Replace the old approach (toggle a form below a table row) with a modal window.
      </p>

      <h3>Before (common pattern you remove)</h3>
      <ul>
        <li>Local state like <code>showForm</code> / <code>setShowForm</code></li>
        <li>Conditional rendering inside row: <code>{showForm &amp;&amp; &lt;CreateCabinForm /&gt;}</code></li>
      </ul>

      <h3>After (compound modal)</h3>
      <pre><code>&lt;Modal&gt;
  &lt;Modal.Open opens="edit"&gt;
    &lt;button&gt;
      &lt;HiPencil /&gt;
    &lt;/button&gt;
  &lt;/Modal.Open&gt;

  &lt;Modal.Window name="edit"&gt;
    &lt;CreateCabinForm cabinToEdit={cabin} /&gt;
  &lt;/Modal.Window&gt;
&lt;/Modal&gt;</code></pre>

      <div class="callout">
        <strong>Why this works:</strong>
        Modal manages <code>openName</code> internally. Clicking the trigger sets <code>openName</code> to <code>"edit"</code> and the window renders.
      </div>

      <h3>Expected behavior</h3>
      <ul>
        <li>‚úÖ Clicking ‚úèÔ∏è opens the edit form for the correct cabin (prefilled).</li>
        <li>‚úÖ On success (edit mutation), modal closes (because modal injects <code>onCloseModal</code> into the child).</li>
      </ul>
    </section>

    <section>
      <h2>üóëÔ∏è Step 3 ‚Äî Confirm deletion in a modal (ConfirmDelete)</h2>
      <p>
        Instead of deleting immediately when the trash icon is clicked, open a confirmation dialog.
      </p>

      <div class="grid2">
        <div>
          <h3>ConfirmDelete props (what it needs)</h3>
          <ul>
            <li><code>resourceName</code> ‚Äî label like ‚Äúcabins‚Äù</li>
            <li><code>onConfirm</code> ‚Äî function to run when user confirms</li>
            <li><code>disabled</code> ‚Äî typically mutation loading state</li>
          </ul>
        </div>
        <div>
          <h3>How it appears</h3>
          <ul>
            <li>Shows ‚ÄúAre you sure?‚Äù copy</li>
            <li>Cancel button closes modal</li>
            <li>Delete button runs delete mutation</li>
          </ul>
        </div>
      </div>

      <h3>CabinRow implementation</h3>
      <pre><code>&lt;Modal&gt;
  &lt;Modal.Open opens="delete"&gt;
    &lt;button&gt;
      &lt;HiTrash /&gt;
    &lt;/button&gt;
  &lt;/Modal.Open&gt;

  &lt;Modal.Window name="delete"&gt;
    &lt;ConfirmDelete
      resourceName="cabins"
      disabled={isDeleting}
      onConfirm={() =&gt; deleteCabin(cabin.id)}
    /&gt;
  &lt;/Modal.Window&gt;
&lt;/Modal&gt;</code></pre>

      <div class="callout">
        <strong>Important:</strong>
        Deletion should only happen inside <code>onConfirm</code>, not directly on the trash icon click.
      </div>
    </section>

    <section>
      <h2>üîí Step 4 ‚Äî Make Cancel work (close the modal)</h2>
      <p>
        Since <code>ConfirmDelete</code> is rendered inside <code>Modal.Window</code>, the modal can <strong>inject</strong> <code>onCloseModal</code> into it
        (using <code>cloneElement</code>), just like it did for <code>CreateCabinForm</code>.
      </p>

      <h3>Inside ConfirmDelete</h3>
      <pre><code>function ConfirmDelete({ resourceName, onConfirm, disabled, onCloseModal }) {
  return (
    &lt;div&gt;
      &lt;p&gt;Are you sure you want to delete this {resourceName}?&lt;/p&gt;

      &lt;button onClick={onCloseModal} disabled={disabled}&gt;
        Cancel
      &lt;/button&gt;

      &lt;button onClick={onConfirm} disabled={disabled}&gt;
        Delete
      &lt;/button&gt;
    &lt;/div&gt;
  );
}</code></pre>

      <div class="callout">
        <strong>Why injection matters:</strong>
        You don‚Äôt pass <code>onCloseModal</code> manually from every parent. The modal ‚Äúwires‚Äù close behavior automatically.
      </div>
    </section>

    <section>
      <h2>üß© Why the modal closes after deleting even without explicit close()</h2>
      <p>
        This feels like ‚Äúmagic‚Äù the first time you see it:
      </p>
      <ul>
        <li>You click <strong>Delete</strong> ‚Üí mutation runs ‚Üí cabin row is removed from the UI.</li>
        <li>The modal instance lives <em>inside</em> that row (component tree).</li>
        <li>When the row unmounts, the modal also unmounts, so the portal content disappears too.</li>
      </ul>
      <div class="callout">
        <strong>Takeaway:</strong>
        The modal disappears because the React component that owns it is gone, not necessarily because you called <code>close()</code>.
      </div>
    </section>

    <section>
      <h2>‚ö†Ô∏è Common mistakes & quick checks</h2>
      <ul>
        <li>‚ùå <strong>Mismatch between</strong> <code>opens</code> and <code>name</code> (e.g., <code>opens="Edit"</code> vs <code>name="edit"</code>).</li>
        <li>‚ùå Passing <code>onConfirm={deleteCabin(cabin.id)}</code> (this executes immediately). Use a function: <code>() =&gt; deleteCabin(cabin.id)</code>.</li>
        <li>‚ùå Forgetting to disable buttons using loading state ‚Üí users can double-submit.</li>
        <li>‚úÖ Verify: Edit form closes on success (means <code>onCloseModal</code> injection is working).</li>
      </ul>
    </section>

    <section>
      <h2>üìå Summary (What to remember)</h2>
      <ul>
        <li>üß± Compound modal makes your UI reusable: <code>Modal.Open</code> + <code>Modal.Window</code>.</li>
        <li>‚úèÔ∏è Editing = open ‚Äúedit‚Äù window and render <code>CreateCabinForm</code> with <code>cabinToEdit</code>.</li>
        <li>üóëÔ∏è Deleting = open ‚Äúdelete‚Äù window and render <code>ConfirmDelete</code>.</li>
        <li>üß† Modal can inject <code>onCloseModal</code> to any child in the window (via cloning).</li>
      </ul>
      <p>
        Next: this modal will be reused even more (e.g., edit form in a modal everywhere) ‚úÖ
      </p>
    </section>
  </main>
</body>
</html>