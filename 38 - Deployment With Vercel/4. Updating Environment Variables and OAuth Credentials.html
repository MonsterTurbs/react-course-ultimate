

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wild Oasis ‚Äî Fixing Auth After Vercel Deploy (Env Vars + Google OAuth)</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #111111;
      --muted: #555555;
      --border: #e6e6e6;
      --soft: #fafafa;
      --chip: #f3f4f6;
    }

    /* Base */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Arial, Helvetica, sans-serif;
      line-height: 1.6;
      overflow-wrap: anywhere;
      word-break: break-word;
    }

    /* Single-column layout */
    .page {
      max-width: 860px;
      margin: 0 auto;
      padding: 28px 22px 42px;
    }

    header {
      border-bottom: 2px solid var(--border);
      padding-bottom: 14px;
      margin-bottom: 18px;
    }

    h1 {
      font-size: 22px;
      margin: 0 0 6px;
      letter-spacing: 0.2px;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 13.5px;
    }

    h2 {
      font-size: 16.5px;
      margin: 18px 0 10px;
    }

    h3 {
      font-size: 14.5px;
      margin: 14px 0 8px;
    }

    p { margin: 10px 0; }
    ul, ol { margin: 8px 0 10px 18px; }
    li { margin: 6px 0; }

    .callout {
      border: 1px solid var(--border);
      background: var(--soft);
      padding: 12px 12px;
      border-radius: 10px;
      margin: 12px 0;
    }

    .callout strong { display: inline-block; margin-bottom: 4px; }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin: 10px 0;
    }

    .card {
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 10px;
      padding: 12px;
    }

    .chips { margin-top: 8px; display: flex; flex-wrap: wrap; gap: 8px; }
    .chip {
      display: inline-block;
      padding: 4px 8px;
      background: var(--chip);
      border: 1px solid var(--border);
      border-radius: 999px;
      font-size: 12px;
      color: #222;
    }

    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.5px;
    }

    pre {
      margin: 10px 0;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fff;
      white-space: pre-wrap;
      overflow-wrap: anywhere;
    }

    .muted { color: var(--muted); }

    .divider {
      border: 0;
      border-top: 1px solid var(--border);
      margin: 16px 0;
    }

    /* Print (A4) */
    @page { size: A4; margin: 14mm; }

    @media print {
      body { background: #fff; }
      .page { max-width: none; padding: 0; }

      /* Avoid printing URLs after links */
      a[href]:after { content: "" !important; }

      /* Keep sections readable */
      header { break-after: avoid; }
      h2, h3 { break-after: avoid; }
      .card, .callout, pre { break-inside: avoid; }
    }
  </style>
</head>

<body>
  <main class="page">
    <header>
      <h1>üîê Fixing Authentication After Deploy (Vercel + NextAuth + Google OAuth)</h1>
      <p class="subtitle">Study Guide / Reviewer ‚Äî Environment Variables, OAuth Redirect URIs, Redeploy, and the ‚Äúlocalhost‚Äù login bug</p>
    </header>

    <section>
      <h2>üß≠ The Problem This Video Fixes</h2>
      <p>
        After deploying to <strong>Vercel</strong>, login may still redirect to <code>http://localhost:3000</code> or show <em>Access blocked</em>.
        This usually happens because:
      </p>
      <ul>
        <li>‚úÖ <strong>NEXTAUTH_URL</strong> is still set to <code>http://localhost:3000</code> (or has a mismatching trailing slash), and/or</li>
        <li>‚úÖ Your <strong>Google OAuth Client</strong> is missing the <strong>production redirect URL</strong> for your deployed domain.</li>
      </ul>

      <div class="callout">
        <strong>üí° Key idea:</strong>
        Environment variables are read at <em>deployment time</em> on Vercel. Changing them requires a <strong>redeploy</strong> to take effect.
      </div>
    </section>

    <hr class="divider" />

    <section>
      <h2>üß† Core Concepts (Beginner-Friendly)</h2>

      <div class="grid">
        <div class="card">
          <h3>1) Environment variables (on Vercel)</h3>
          <p>
            Environment variables are settings your app uses while running. For NextAuth, <strong>NEXTAUTH_URL</strong>
            tells NextAuth the ‚Äúbase URL‚Äù of your app.
          </p>
          <div class="chips">
            <span class="chip">NEXTAUTH_URL</span>
            <span class="chip">Deployment-time config</span>
            <span class="chip">Must match your domain</span>
          </div>
        </div>

        <div class="card">
          <h3>2) OAuth redirect URLs (Google)</h3>
          <p>
            When you click ‚ÄúSign in with Google,‚Äù Google needs to know where it is allowed to send you back.
            That ‚Äúreturn address‚Äù is called a <strong>Redirect URI</strong>.
          </p>
          <p class="muted">
            If the Redirect URI is missing or mismatched, you‚Äôll commonly see <strong>Access blocked</strong>.
          </p>
          <div class="chips">
            <span class="chip">Google Cloud Console</span>
            <span class="chip">Credentials ‚Üí OAuth Client</span>
            <span class="chip">Authorized redirect URIs</span>
          </div>
        </div>

        <div class="card">
          <h3>3) Redeploy (why it matters)</h3>
          <p>
            Updating Vercel env vars does <strong>not</strong> instantly update your already-built deployment.
            You must <strong>redeploy</strong> so the new variables are baked into the build.
          </p>
          <div class="chips">
            <span class="chip">Vercel ‚Üí Deployments</span>
            <span class="chip">Redeploy</span>
          </div>
        </div>
      </div>
    </section>

    <hr class="divider" />

    <section>
      <h2>‚úÖ Step-by-Step Checklist (What to Do)</h2>

      <h3>Step A ‚Äî Update NEXTAUTH_URL in Vercel</h3>
      <ol>
        <li>Go to <strong>Vercel Dashboard</strong> ‚Üí your project ‚Üí <strong>Settings</strong> ‚Üí <strong>Environment Variables</strong>.</li>
        <li>Find <code>NEXTAUTH_URL</code> and set it to your deployed domain, for example:</li>
      </ol>
      <pre>https://your-project-name.vercel.app</pre>

      <div class="callout">
        <strong>‚ö†Ô∏è Important: trailing slash</strong>
        <p>
          Be consistent. If Google OAuth uses <code>https://your-project-name.vercel.app</code>
          but your env var is <code>https://your-project-name.vercel.app/</code> (note the <strong>/</strong>),
          you can get an auth mismatch.
        </p>
        <p class="muted">Rule of thumb: set <code>NEXTAUTH_URL</code> <strong>without</strong> a trailing slash.</p>
      </div>

      <h3>Step B ‚Äî Redeploy so env vars take effect</h3>
      <ol>
        <li>Vercel Dashboard ‚Üí <strong>Deployments</strong>.</li>
        <li>Choose the latest deployment ‚Üí click <strong>Redeploy</strong>.</li>
      </ol>

      <h3>Step C ‚Äî Update Google OAuth Redirect URI</h3>
      <ol>
        <li>Open <strong>Google Cloud Console</strong> ‚Üí select your project.</li>
        <li>Go to <strong>APIs &amp; Services</strong> ‚Üí <strong>Credentials</strong>.</li>
        <li>Open your <strong>OAuth 2.0 Client ID</strong>.</li>
        <li>In <strong>Authorized redirect URIs</strong>, add the production callback:</li>
      </ol>
      <pre>https://your-project-name.vercel.app/api/auth/callback/google</pre>

      <div class="callout">
        <strong>üß© Keep localhost for local dev</strong>
        <p>
          You can keep your localhost redirect URI so login keeps working during development, e.g.:
        </p>
        <pre>http://localhost:3000/api/auth/callback/google</pre>
        <p class="muted">Production and localhost can coexist in the same OAuth client configuration.</p>
      </div>

      <h3>Step D ‚Äî Wait for propagation (if needed)</h3>
      <p>
        Sometimes Google changes can take a few minutes to take effect. If you still see <em>Access blocked</em>,
        wait briefly and retry.
      </p>
    </section>

    <hr class="divider" />

    <section>
      <h2>üõ† Troubleshooting Guide</h2>

      <div class="card">
        <h3>Issue: Login redirects to <code>localhost:3000</code></h3>
        <ul>
          <li>‚úÖ Check <code>NEXTAUTH_URL</code> is your Vercel URL (not localhost).</li>
          <li>‚úÖ Redeploy after changing env vars.</li>
        </ul>
      </div>

      <div class="card">
        <h3>Issue: ‚ÄúAccess blocked‚Äù / invalid_request / redirect_uri_mismatch</h3>
        <ul>
          <li>‚úÖ Confirm the Redirect URI matches <em>exactly</em> (protocol, domain, path).</li>
          <li>‚úÖ Ensure no accidental double slashes like <code>https://site.vercel.app//api/auth/...</code></li>
          <li>‚úÖ Fix trailing slash mismatch between <code>NEXTAUTH_URL</code> and OAuth settings.</li>
          <li>‚úÖ Wait a few minutes for Google changes to propagate.</li>
        </ul>
      </div>

      <div class="card">
        <h3>Quick ‚Äúsanity check‚Äù examples</h3>
        <p class="muted">These are the two values that must be aligned:</p>
        <pre>
NEXTAUTH_URL:
  https://your-project-name.vercel.app

Google Redirect URI:
  https://your-project-name.vercel.app/api/auth/callback/google
        </pre>
      </div>
    </section>

    <hr class="divider" />

    <section>
      <h2>üìå Why This Matters in Real Projects</h2>
      <ul>
        <li>‚úÖ Environment variables differ between <strong>local</strong> and <strong>production</strong> environments.</li>
        <li>‚úÖ OAuth providers require strict URL matching for security.</li>
        <li>‚úÖ ‚ÄúWorks locally‚Äù does not guarantee ‚Äúworks in production‚Äù without correct credentials.</li>
      </ul>

      <div class="callout">
        <strong>üéØ Practical takeaway:</strong>
        Treat auth setup as a deployment checklist item, not a one-time setup.
      </div>
    </section>

    <hr class="divider" />

    <section>
      <h2>üèÅ Wrap-up Summary (Memory Checklist)</h2>
      <ul>
        <li>üîß Update <code>NEXTAUTH_URL</code> in Vercel to the deployed URL.</li>
        <li>üöÄ Redeploy so env vars are applied.</li>
        <li>üîê Add production <strong>Google OAuth Redirect URI</strong> for NextAuth callback.</li>
        <li>‚ö†Ô∏è Watch out for trailing slashes and double slashes.</li>
        <li>üïí If needed, wait briefly for Google settings to propagate.</li>
      </ul>

      <p class="muted">
        After this, authentication should work correctly on the live Vercel domain.
      </p>
    </section>
  </main>
</body>
</html>