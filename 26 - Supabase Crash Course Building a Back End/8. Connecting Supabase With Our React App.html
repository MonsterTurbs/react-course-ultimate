

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Supabase + React â€” Connecting Supabase With Our React App (Study Guide)</title>
  <style>
    /* =========================
       A4 PRINT-FRIENDLY SETTINGS
       ========================= */
    @page {
      size: A4;
      margin: 14mm 14mm 16mm;
    }

    :root {
      --bg: #ffffff;
      --text: #111111;
      --muted: #555555;
      --border: #e6e6e6;
      --soft: #fafafa;
      --soft2: #f5f7fb;
      --codebg: #0b1020;
      --codefg: #e6edf3;
      --accent: #1f6feb;
      --accent2: #0b57d0;
      --ok: #0f7b3a;
      --warn: #9a6a00;
      --bad: #b42318;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Arial, Helvetica, sans-serif;
      line-height: 1.6;
      overflow-wrap: anywhere;
      word-break: break-word;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* Single-column page container */
    .page {
      max-width: 820px;
      margin: 0 auto;
      padding: 18px 18px 28px;
    }

    header {
      border: 1px solid var(--border);
      background: var(--soft);
      border-radius: 12px;
      padding: 16px 16px 12px;
      margin-bottom: 14px;
    }

    h1 {
      font-size: 22px;
      line-height: 1.2;
      margin: 0 0 8px;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 13.5px;
    }

    .meta {
      margin-top: 10px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      font-size: 12.5px;
      color: var(--muted);
    }

    .chiprow {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .chip {
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      color: #222;
      white-space: nowrap;
    }

    nav {
      margin: 12px 0 16px;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 14px;
      background: #fff;
    }

    nav h2 {
      margin: 0 0 8px;
      font-size: 14.5px;
    }

    nav ul {
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 13px;
    }

    nav a {
      color: var(--accent2);
      text-decoration: none;
    }

    section {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px;
      background: #fff;
      margin: 0 0 12px;
    }

    h2 {
      margin: 0 0 10px;
      font-size: 16.5px;
      line-height: 1.25;
    }

    h3 {
      margin: 14px 0 8px;
      font-size: 14.5px;
      line-height: 1.25;
    }

    p { margin: 8px 0; }

    .callout {
      border: 1px solid var(--border);
      background: var(--soft2);
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0;
    }

    .callout .title {
      font-weight: 700;
      margin: 0 0 6px;
      display: flex;
      gap: 8px;
      align-items: baseline;
    }

    .callout.ok { border-color: rgba(15,123,58,.35); background: rgba(15,123,58,.06); }
    .callout.warn { border-color: rgba(154,106,0,.35); background: rgba(154,106,0,.06); }
    .callout.bad { border-color: rgba(180,35,24,.35); background: rgba(180,35,24,.06); }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .kvs {
      border: 1px dashed var(--border);
      border-radius: 12px;
      padding: 12px;
      background: #fff;
    }

    .kvs h4 {
      margin: 0 0 8px;
      font-size: 13.5px;
    }

    .kvs ul {
      margin: 0;
      padding-left: 18px;
      color: #222;
    }

    .kvs li { margin: 6px 0; }

    pre {
      margin: 10px 0;
      padding: 12px;
      border-radius: 12px;
      background: var(--codebg);
      color: var(--codefg);
      overflow: auto;
      border: 1px solid rgba(255,255,255,.12);
      font-size: 12.5px;
      line-height: 1.55;
      white-space: pre;
      tab-size: 2;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.95em;
    }

    .inline-code {
      background: #f3f4f6;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1px 6px;
    }

    .steps {
      margin: 8px 0 0;
      padding-left: 18px;
    }

    .steps li { margin: 8px 0; }

    .checklist {
      margin: 10px 0 0;
      padding-left: 0;
      list-style: none;
    }

    .checklist li {
      margin: 8px 0;
      padding-left: 26px;
      position: relative;
    }

    .checklist li::before {
      content: "â˜";
      position: absolute;
      left: 0;
      top: 0;
      color: #222;
    }

    .twocol {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .small { font-size: 12.5px; color: var(--muted); }

    .avoid-break {
      break-inside: avoid;
      page-break-inside: avoid;
    }

    /* =========================
       PRINT RULES
       ========================= */
    @media print {
      body { background: #fff; }
      .page { padding: 0; max-width: none; }
      nav a { text-decoration: none; color: #000; }

      /* Donâ€™t print link URLs */
      a[href]::after { content: "" !important; }

      /* Reduce ink-heavy code blocks slightly */
      pre {
        background: #0b1020;
        color: #e6edf3;
      }

      /* Keep sections from breaking awkwardly */
      header, section, nav { break-inside: avoid; page-break-inside: avoid; }

      /* Hide any UI-only hints if added later */
      .no-print { display: none !important; }
    }
  </style>
</head>
<body>
  <main class="page">
    <header class="avoid-break">
      <h1>ğŸ”— Supabase + React â€” Connecting Supabase With Our React App</h1>
      <p class="subtitle">
        Reviewer / Study Guide (Beginner-Friendly): how to install <span class="inline-code">@supabase/supabase-js</span>, create a client, safely use the anon key with RLS, and build your first service function (Cabins).
      </p>
      <div class="chiprow" aria-label="tags">
        <span class="chip">ğŸ§  Concepts: Client, Service Layer, RLS</span>
        <span class="chip">ğŸ› ï¸ Tools: Supabase JS, React</span>
        <span class="chip">âœ… Goal: Fetch cabins data</span>
      </div>
      <div class="meta">
        <div>ğŸ“ Focus: Using the Supabase client library (not raw REST URLs) and verifying the connection by logging fetched data.</div>
        <div>ğŸ–¨ï¸ Print tip: This page is formatted for A4 single-column printing on white paper.</div>
      </div>
    </header>

    <nav class="avoid-break" aria-label="Table of contents">
      <h2>ğŸ“Œ Table of Contents</h2>
      <ul>
        <li><a href="#big-picture">Big picture (what we are building)</a></li>
        <li><a href="#install">Step 1 â€” Install Supabase JS</a></li>
        <li><a href="#client">Step 2 â€” Create the Supabase client</a></li>
        <li><a href="#keys-rls">Why the anon key is safe (RLS)</a></li>
        <li><a href="#service">Step 3 â€” Create a service: <code>getCabins</code></a></li>
        <li><a href="#test">Step 4 â€” Quick test in the Cabins page</a></li>
        <li><a href="#pitfalls">Common mistakes + quick fixes</a></li>
        <li><a href="#checklist">Final checklist</a></li>
      </ul>
    </nav>

    <section id="big-picture" class="avoid-break">
      <h2>ğŸŒ Big picture (what we are building)</h2>
      <p>
        We already created tables in Supabase (like <strong>cabins</strong>, <strong>guests</strong>, <strong>bookings</strong>, <strong>settings</strong>). Now we want our React app to <strong>read</strong> that data.
      </p>
      <div class="callout ok">
        <p class="title">âœ… Key idea</p>
        <p>
          Supabase gives you two ways to talk to the backend:
        </p>
        <ul>
          <li>ğŸŒ <strong>REST API URL</strong> (raw HTTP requests)</li>
          <li>ğŸ“¦ <strong>JavaScript client library</strong> (what we will use)</li>
        </ul>
        <p>
          Using the JS client is usually simpler, cleaner, and less error-prone.
        </p>
      </div>
    </section>

    <section id="install" class="avoid-break">
      <h2>ğŸ“¦ Step 1 â€” Install Supabase JS</h2>
      <p>
        Install the Supabase JavaScript client inside your React project.
      </p>
      <pre><code>npm install @supabase/supabase-js</code></pre>
      <div class="callout warn">
        <p class="title">âš ï¸ Reminder</p>
        <p>
          Run this command in the root of your project (where <span class="inline-code">package.json</span> is).
        </p>
      </div>
    </section>

    <section id="client" class="avoid-break">
      <h2>ğŸ§© Step 2 â€” Create the Supabase client</h2>
      <p>
        Create a file (commonly in <span class="inline-code">src/services</span>) that initializes a single Supabase client.
        This client is what you will import everywhere to run queries.
      </p>

      <h3>ğŸ“„ Example file: <span class="inline-code">src/services/supabase.js</span></h3>
      <pre><code>import { createClient } from "@supabase/supabase-js";

const supabaseUrl = "YOUR_SUPABASE_PROJECT_URL";
const supabaseKey = "YOUR_SUPABASE_ANON_KEY";

const supabase = createClient(supabaseUrl, supabaseKey);

export default supabase;</code></pre>

      <div class="grid">
        <div class="kvs">
          <h4>ğŸ” Where do you get these values?</h4>
          <ul>
            <li>Supabase Dashboard â†’ Project Settings â†’ <strong>API</strong></li>
            <li>Copy the <strong>Project URL</strong> and the <strong>anon (public) key</strong></li>
          </ul>
        </div>
      </div>

      <div class="callout warn">
        <p class="title">ğŸ§¯ Best practice (real-world)</p>
        <p>
          In production, store keys in environment variables (like <span class="inline-code">.env</span>) and do not hardcode them.
          But for learning, copying into the file is OK.
        </p>
      </div>
    </section>

    <section id="keys-rls" class="avoid-break">
      <h2>ğŸ›¡ï¸ Why the anon key is safe (Row Level Security / RLS)</h2>
      <p>
        It feels scary to put an API key in a frontend app. That fear is valid <em>unless</em> you use Supabase correctly.
      </p>

      <div class="callout ok">
        <p class="title">âœ… The rule</p>
        <p>
          The <strong>anon key is safe in the browser</strong> <em>only if</em> you enabled <strong>Row Level Security (RLS)</strong> and wrote proper policies.
        </p>
      </div>

      <div class="callout bad">
        <p class="title">ğŸš¨ What happens without RLS?</p>
        <p>
          If RLS is OFF (or policies are too permissive), anyone with the anon key could potentially read/update/delete data.
        </p>
      </div>

      <div class="callout warn">
        <p class="title">ğŸ§  Simple analogy</p>
        <p>
          Think of the anon key like an <strong>ID card</strong>. RLS policies are the <strong>security guards</strong>.
          The ID card alone doesnâ€™t grant access; the guards decide what you can do.
        </p>
      </div>

      <p class="small">
        In the lecture setup, you initially allow <strong>read-only</strong> access to tables for everyone. Later, you tighten policies to authenticated users only.
      </p>
    </section>

    <section id="service" class="avoid-break">
      <h2>ğŸ§± Step 3 â€” Create a service: <code>getCabins</code></h2>
      <p>
        A clean architecture is to create one API/service file per table. Example: <span class="inline-code">apiCabins.js</span> for the <strong>cabins</strong> table.
      </p>

      <h3>ğŸ“„ Example file: <span class="inline-code">src/services/apiCabins.js</span></h3>
      <pre><code>import supabase from "./supabase";

export async function getCabins() {
  const { data, error } = await supabase.from("cabins").select("*");

  if (error) {
    console.error("Cabins could not be loaded", error);
    throw new Error("Cabins could not be loaded");
  }

  return data;
}</code></pre>

      <div class="callout ok">
        <p class="title">âœ… What this code does</p>
        <ul>
          <li>ğŸ“Œ <span class="inline-code">from("cabins")</span> selects the table</li>
          <li>ğŸ“Œ <span class="inline-code">select("*")</span> returns all columns for all rows</li>
          <li>ğŸ§¯ If Supabase returns an <span class="inline-code">error</span>, we throw an Error so the UI can handle it</li>
        </ul>
      </div>

      <div class="callout warn">
        <p class="title">ğŸ§ª Tip for debugging</p>
        <p>
          If you get an empty array, it might mean either:
        </p>
        <ul>
          <li>ğŸ“­ Your table has no rows yet, or</li>
          <li>ğŸ”’ RLS policy blocks your read access (common during setup)</li>
        </ul>
      </div>
    </section>

    <section id="test" class="avoid-break">
      <h2>ğŸ§ª Step 4 â€” Quick test in the Cabins page (temporary)</h2>
      <p>
        For a quick â€œproof it worksâ€ test, you can fetch cabins inside a page component and log the result.
        (Later you will use React Query, and pages will avoid side effects.)
      </p>

      <h3>ğŸ§¾ Example: inside <span class="inline-code">Cabins.jsx</span> page</h3>
      <pre><code>import { useEffect } from "react";
import { getCabins } from "../services/apiCabins";

function Cabins() {
  useEffect(function () {
    getCabins().then((data) =&gt; console.log(data));
  }, []);

  return (
    &lt;div&gt;
      &lt;h1&gt;Cabins&lt;/h1&gt;
      &lt;!-- UI will be built later --&gt;
    &lt;/div&gt;
  );
}

export default Cabins;</code></pre>

      <div class="callout ok">
        <p class="title">ğŸ‰ Expected result</p>
        <p>
          When you visit the Cabins page, you should see your cabins array in the browser console.
          If you inserted a test cabin in Supabase, it should appear here.
        </p>
      </div>

      <div class="callout warn">
        <p class="title">ğŸ§­ What happens next (in the course)</p>
        <p>
          This temporary pattern gets replaced by React Query so data fetching is cached, refetched automatically, and handled consistently.
        </p>
      </div>
    </section>

    <section id="pitfalls" class="avoid-break">
      <h2>ğŸ§¯ Common mistakes + quick fixes</h2>

      <div class="twocol">
        <div class="kvs avoid-break">
          <h4>âŒ â€œI get an empty arrayâ€</h4>
          <ul>
            <li>Make sure the table has rows (insert at least one test cabin).</li>
            <li>Check RLS: add a <strong>SELECT</strong> policy for the table you are reading.</li>
          </ul>
        </div>

        <div class="kvs avoid-break">
          <h4>âŒ â€œCabins could not be loadedâ€ (error thrown)</h4>
          <ul>
            <li>Double-check the table name string: <span class="inline-code">"cabins"</span> must match exactly.</li>
            <li>Verify Project URL and anon key were copied correctly.</li>
            <li>Check the browser console Network tab for failed requests.</li>
          </ul>
        </div>

        <div class="kvs avoid-break">
          <h4>âŒ â€œCannot find module ./supabaseâ€</h4>
          <ul>
            <li>Confirm the import path is correct for your folder structure.</li>
            <li>Confirm the file name matches (case-sensitive on many systems).</li>
          </ul>
        </div>

        <div class="kvs avoid-break">
          <h4>âŒ â€œIâ€™m worried about exposing the keyâ€</h4>
          <ul>
            <li>Use <strong>anon</strong> (public) key only.</li>
            <li>Enable <strong>RLS</strong> and allow only the operations you want.</li>
            <li>Never put the <strong>service role</strong> key in the frontend.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="checklist" class="avoid-break">
      <h2>âœ… Final checklist (printable)</h2>
      <ul class="checklist">
        <li>Installed Supabase JS: <span class="inline-code">npm install @supabase/supabase-js</span></li>
        <li>Created <span class="inline-code">supabase.js</span> with <span class="inline-code">createClient(url, anonKey)</span></li>
        <li>Copied the correct <strong>Project URL</strong> and <strong>anon key</strong> from Supabase Settings â†’ API</li>
        <li>Enabled RLS + added a <strong>SELECT policy</strong> (at least for development)</li>
        <li>Created <span class="inline-code">apiCabins.js</span> with <span class="inline-code">getCabins()</span></li>
        <li>Tested by calling <span class="inline-code">getCabins()</span> and seeing the array in the console</li>
      </ul>

      <div class="callout ok">
        <p class="title">ğŸ Outcome</p>
        <p>
          You now have a working full-stack connection: React â†’ Supabase API â†’ Postgres tables.
          From here, you can build the real UI and replace console logs with React Query.
        </p>
      </div>
    </section>

    <section class="avoid-break">
      <h2>ğŸ§  Quick recap</h2>
      <ol class="steps">
        <li>Install Supabase client library ğŸ“¦</li>
        <li>Create and export one Supabase client ğŸ”Œ</li>
        <li>Use RLS policies to control what the anon key can do ğŸ›¡ï¸</li>
        <li>Create service functions per table (example: <span class="inline-code">getCabins</span>) ğŸ§±</li>
        <li>Test quickly in a page, then later move to React Query ğŸš€</li>
      </ol>
      <p class="small">
        If you want, you can repeat the same pattern for <strong>guests</strong>, <strong>bookings</strong>, and <strong>settings</strong> services.
      </p>
    </section>

  </main>
</body>
</html>