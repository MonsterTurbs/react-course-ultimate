<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>React Study Guide â€” Booking Detail Page (Route Params + React Query useBooking + Menus)</title>
  <style>
    :root{
      --bg:#ffffff;
      --text:#111111;
      --muted:#555555;
      --border:#e6e6e6;
      --panel:#fafafa;
      --chip:#f3f4f6;
      --link:#0b57d0;
      --shadow: 0 8px 30px rgba(0,0,0,.06);

      /* High-contrast code theme */
      --code-bg:#0b1220;
      --code-text:#e6edf3;
      --code-border:#1f2937;
      --inline-bg:#eef2ff;
      --inline-border:#dbeafe;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: Arial, Helvetica, sans-serif;
      line-height:1.65;
      overflow-wrap:anywhere;
      word-break:normal;
    }

    .page{
      max-width: 980px;
      margin: 0 auto;
      padding: 28px 18px 56px;
    }

    header{
      padding: 18px 18px;
      border:1px solid var(--border);
      border-radius: 14px;
      background: linear-gradient(180deg, #fff, var(--panel));
      box-shadow: var(--shadow);
    }

    h1{
      margin: 0 0 8px;
      font-size: 24px;
      letter-spacing: .2px;
      line-height: 1.25;
    }

    .subtitle{
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }

    .toolbar{
      margin-top: 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .btn{
      appearance:none;
      border:1px solid var(--border);
      background:#fff;
      border-radius: 10px;
      padding: 9px 12px;
      cursor:pointer;
      font-weight:600;
      font-size: 13px;
    }
    .btn:hover{ border-color:#cfcfcf; }
    .btn:active{ transform: translateY(1px); }

    .meta{
      margin-left:auto;
      color:var(--muted);
      font-size: 12px;
    }

    main{
      margin-top: 18px;
      padding: 18px;
      border:1px solid var(--border);
      border-radius: 14px;
      background:#fff;
      box-shadow: var(--shadow);
    }

    h2{
      margin: 18px 0 10px;
      font-size: 18px;
      line-height: 1.25;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 15px;
      line-height: 1.3;
    }

    p{ margin: 8px 0; }
    ul{ margin: 8px 0 8px 20px; padding:0; }
    li{ margin: 6px 0; }

    .callout{
      border:1px solid var(--border);
      background: var(--panel);
      border-radius: 12px;
      padding: 12px 12px;
      margin: 12px 0;
    }

    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin: 10px 0 0;
      padding: 0;
      list-style:none;
    }
    .chip{
      background: var(--chip);
      border:1px solid var(--border);
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
      color:#222;
    }

    .divider{
      height:1px;
      background:var(--border);
      margin: 16px 0;
    }

    .small{ color:var(--muted); font-size: 13px; }

    /* Code blocks */
    code, pre{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                   "Liberation Mono", "Courier New", monospace;
    }
    code{
      background: var(--inline-bg);
      color:#111111;
      padding: 1px 6px;
      border-radius: 6px;
      border: 1px solid var(--inline-border);
      font-size: 0.95em;
      opacity: 1 !important;
    }
    pre{
      margin: 10px 0;
      padding: 12px 14px;
      border-radius: 12px;
      background: var(--code-bg);
      color: var(--code-text);
      border: 1px solid var(--code-border);
      overflow:auto;
      max-width: 100%;
      box-shadow: 0 2px 14px rgba(0,0,0,.10);
      opacity: 1 !important;
    }
    pre code{
      background: transparent !important;
      border: 0 !important;
      padding: 0 !important;
      border-radius: 0 !important;
      color: inherit !important;
      font-size: 12.8px;
      line-height: 1.6;
      white-space: pre-wrap;
      overflow-wrap: anywhere;
      word-break: break-word;
      opacity: 1 !important;
    }

    @media print{
      @page{ size: A4; margin: 12mm; }
      body{ background:#fff; }
      .page{ padding: 0; margin: 0; max-width: none; }
      header, main{ box-shadow: none; }
      header{ break-inside: avoid; }
      .toolbar{ display:none !important; }
      a[href]::after{ content:""; }

      pre{
        background:#ffffff !important;
        color:#111111 !important;
        border: 1px solid #d0d0d0 !important;
        box-shadow: none !important;
        overflow: visible !important;
      }
      pre code{
        white-space: pre-wrap !important;
        overflow-wrap: anywhere !important;
        word-break: break-word !important;
      }

      .callout{ break-inside: avoid; }
      h2{ break-after: avoid; }
    }
  </style>
</head>

<body>
  <div class="page">
    <header>
      <h1>ğŸ“„ Booking Detail Page â€” Route Params + React Query + Menus</h1>
      <p class="subtitle">
        Goal: build a dedicated page that shows all details for a single booking.
        Flow: click â€œSee detailsâ€ in the BookingRow menu â†’ navigate to <code>/bookings/:bookingId</code> â†’ fetch booking via React Query â†’ render BookingDataBox.
      </p>

      <div class="toolbar">
        <button class="btn" type="button" onclick="window.print()">ğŸ–¨ï¸ Print / Save as PDF</button>
        <button class="btn" type="button" onclick="window.scrollTo({top:0,behavior:'smooth'})">â¬†ï¸ Back to Top</button>
        <span class="meta">Single-column â€¢ A4 print-ready â€¢ High-contrast code</span>
      </div>

      <ul class="chips" aria-label="key tags">
        <li class="chip">ğŸ“„ Detail page</li>
        <li class="chip">ğŸ§­ React Router</li>
        <li class="chip">ğŸ§© Menus compound component</li>
        <li class="chip">ğŸ”¢ URL params</li>
        <li class="chip">âš¡ React Query</li>
        <li class="chip">ğŸ§± Presentational component</li>
      </ul>
    </header>

    <main>
      <h2>1) Why we need a Booking Detail page</h2>
      <p>
        Now that the bookings table is complete, the next step is a page that shows a single booking in full detail:
      </p>
      <ul>
        <li>ğŸ  Cabin info + number of nights</li>
        <li>ğŸ™ Guest info (name, country, etc.)</li>
        <li>ğŸ³ Breakfast / extras info</li>
        <li>ğŸ’° Total price</li>
        <li>ğŸ—“ï¸ Booking creation date</li>
      </ul>

      <div class="divider"></div>

      <h2>2) Navigation: add â€œSee detailsâ€ to BookingRow menu</h2>
      <p>
        Each booking row already lives inside the <code>Menus</code> compound component wrapper (like CabinRow earlier).
        Now you add a menu per row:
      </p>
      <ul>
        <li><code>&lt;Menus.Menu&gt;</code></li>
        <li><code>&lt;Menus.Toggle id={bookingId} /&gt;</code></li>
        <li><code>&lt;Menus.List id={bookingId}&gt;...&lt;/Menus.List&gt;</code></li>
        <li><code>&lt;Menus.Button&gt;</code> actions (like â€œSee detailsâ€)</li>
      </ul>

      <pre><code>// BookingRow.jsx (conceptual)
import { HiEye } from "react-icons/hi2";
import { useNavigate } from "react-router-dom";

function BookingRow({ booking }) {
  const navigate = useNavigate();

  return (
    &lt;Table.Row&gt;
      {/* ...cells... */}

      &lt;Menus.Menu&gt;
        &lt;Menus.Toggle id={booking.id} /&gt;

        &lt;Menus.List id={booking.id}&gt;
          &lt;Menus.Button
            icon={&lt;HiEye /&gt;}
            onClick={() =&gt; navigate(`/bookings/${booking.id}`)}
          &gt;
            See details
          &lt;/Menus.Button&gt;
        &lt;/Menus.List&gt;
      &lt;/Menus.Menu&gt;
    &lt;/Table.Row&gt;
  );
}</code></pre>

      <div class="callout">
        <p><strong>ğŸ§  Why Toggle and List need the same ID</strong></p>
        <p>
          The Menu.Toggle opens the Menu.List that matches the same IDâ€”so each row controls its own menu.
        </p>
      </div>

      <div class="divider"></div>

      <h2>3) Create the route and the page: <code>/bookings/:bookingId</code></h2>
      <p>
        Clicking â€œSee detailsâ€ takes you to a dynamic route that includes the booking ID.
        You add:
      </p>
      <ul>
        <li>ğŸ“„ A new page file (e.g., <code>pages/Booking.jsx</code>)</li>
        <li>ğŸ§­ A new route definition with a param: <code>:bookingId</code></li>
      </ul>

      <pre><code>// Router (conceptual)
{
  path: "bookings/:bookingId",
  element: &lt;Booking /&gt;,
}</code></pre>

      <div class="divider"></div>

      <h2>4) Page responsibility rule: keep pages â€œthinâ€</h2>
      <p>
        The course follows a convention:
      </p>
      <div class="callout">
        <p><strong>âœ… Page components should not fetch data</strong></p>
        <ul>
          <li>Pages are mainly for wiring routes.</li>
          <li>All booking-related logic should live in the <code>features/bookings</code> folder.</li>
          <li>This keeps the <code>pages</code> folder clean and predictable.</li>
        </ul>
      </div>

      <p>
        So the Booking page simply renders the feature component:
      </p>

      <pre><code>// pages/Booking.jsx (conceptual)
import BookingDetail from "../features/bookings/BookingDetail";

export default function Booking() {
  return &lt;BookingDetail /&gt;;
}</code></pre>

      <div class="divider"></div>

      <h2>5) Fetch single booking data (service + hook)</h2>
      <p>
        You need booking details for a single row by ID. This follows the standard pattern:
      </p>
      <ul>
        <li>ğŸ§° Service function: <code>getBooking(bookingId)</code></li>
        <li>âš¡ React Query hook: <code>useBooking()</code></li>
        <li>ğŸ§© Component consumes hook: <code>BookingDetail</code></li>
      </ul>

      <h3>Service: <code>getBooking</code></h3>
      <p>
        The function selects the booking row plus related cabin and guest data. It filters by ID and uses <code>single()</code>
        to return one object (not an array).
      </p>

      <pre><code>// services/apiBookings.js (conceptual)
export async function getBooking(id) {
  const { data, error } = await supabase
    .from("bookings")
    .select("*, cabins(*), guests(*)")
    .eq("id", id)
    .single();

  if (error) throw error;
  return data;
}</code></pre>

      <h3>Hook: <code>useBooking</code> (read ID from URL params inside the hook)</h3>
      <p>
        The lecture chooses to read the route param inside <code>useBooking</code> to keep it self-contained.
      </p>

      <pre><code>// hooks/useBooking.js (conceptual)
import { useQuery } from "@tanstack/react-query";
import { useParams } from "react-router-dom";
import { getBooking } from "../../services/apiBookings";

export function useBooking() {
  const { bookingId } = useParams();

  const { isLoading, data: booking } = useQuery({
    queryKey: ["booking", bookingId],
    queryFn: () =&gt; getBooking(bookingId),
    retry: false, // don't retry for â€œnot foundâ€
  });

  return { isLoading, booking };
}</code></pre>

      <div class="callout">
        <p><strong>ğŸ§  Why <code>retry: false</code>?</strong></p>
        <p>
          If a booking isnâ€™t found, retrying often doesnâ€™t help (it likely doesnâ€™t exist). This avoids wasted requests.
        </p>
      </div>

      <div class="divider"></div>

      <h2>6) BookingDetail component: render spinner â†’ then BookingDataBox</h2>
      <p>
        BookingDetail consumes the hook, shows a spinner while loading, and then renders the UI.
        Once booking data arrives, you can display booking ID and status correctly.
      </p>

      <pre><code>// BookingDetail.jsx (conceptual)
import Spinner from "../../ui/Spinner";
import BookingDataBox from "./BookingDataBox";
import { useBooking } from "./useBooking";

function BookingDetail() {
  const { isLoading, booking } = useBooking();

  if (isLoading) return &lt;Spinner /&gt;;

  const { id, status } = booking;

  return (
    &lt;&gt;
      &lt;Header&gt;
        &lt;h1&gt;Booking #{id}&lt;/h1&gt;
        &lt;StatusTag&gt;{status}&lt;/StatusTag&gt;
      &lt;/Header&gt;

      &lt;BookingDataBox booking={booking} /&gt;
      {/* buttons like check-in, check-out, delete come next */}
    &lt;/&gt;
  );
}</code></pre>

      <div class="callout">
        <p><strong>ğŸ”§ Temporary error handling during build</strong></p>
        <p>
          Initially, <code>BookingDataBox</code> can throw â€œcannot read properties of undefinedâ€ if booking data isnâ€™t ready.
          The solution is the standard pattern: render a spinner until booking exists, then render the data box.
        </p>
      </div>

      <div class="divider"></div>

      <h2>7) BookingDataBox: presentational (reusable) component</h2>
      <p>
        BookingDataBox is purely presentational:
      </p>
      <ul>
        <li>âœ… Receives <code>booking</code> as a prop</li>
        <li>âœ… Destructures values and renders UI</li>
        <li>âœ… No fetching, no side effects</li>
      </ul>

      <div class="callout">
        <p><strong>Why make it its own component?</strong></p>
        <ul>
          <li>Cleaner BookingDetail component</li>
          <li>Reusability (youâ€™ll need it again later)</li>
          <li>Encapsulates complex â€œdisplayâ€ markup</li>
        </ul>
      </div>

      <div class="divider"></div>

      <h2>8) Whatâ€™s next (after the detail page exists)</h2>
      <p>
        Now that you can view booking details, the next lectures add â€œactionsâ€ on this page:
      </p>
      <ul>
        <li>âœ… Check in</li>
        <li>ğŸšª Check out</li>
        <li>ğŸ—‘ï¸ Delete booking</li>
      </ul>

      <div class="divider"></div>

      <h2>9) Quick self-check (practice)</h2>
      <ul>
        <li>ğŸ§© Why does each Menu.Toggle and Menu.List require the same ID?</li>
        <li>ğŸ§­ What does <code>:bookingId</code> mean in a route path?</li>
        <li>ğŸ§  Why keep pages â€œthinâ€ and put logic in the features folder?</li>
        <li>âš¡ Why use <code>["booking", bookingId]</code> as queryKey instead of just <code>["booking"]</code>?</li>
        <li>ğŸ” When does it make sense to set <code>retry: false</code> in React Query?</li>
      </ul>

      <p class="small">
        End of reviewer. Next: add actions (check-in / check-out / delete) on the booking detail page.
      </p>
    </main>
  </div>
</body>
</html>
